<!DOCTYPE html>
<html lang="en" xml:lang="EN" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <link href="favicon.png" rel="icon" type="image/png" />
        <title>Far Verona Sector Map</title>
        <link rel="stylesheet" type="text/css" href="scripts/style.css">
        <link rel="stylesheet" type="text/css" href="scripts/Treant.css">
        <script src="openseadragon/openseadragon.min.js"></script>
        <script src="scripts/openseadragon-svg-overlay.js"></script>
        <script src="scripts/apexcharts.js"></script>
        <script src="scripts/d3.v5.min.js"></script>
        <script src="scripts/Treant.js"></script>
        <script src="scripts/raphael.js"></script>
        <script src="scripts/jquery-3.4.1.min.js"></script>
        <script src="scripts/constants.js"></script>
        <script type="text/javascript">
            // Global variables
            let highlighted_asset = '';
            let show_inactive = false;
            let show_factionTable = true;
            let show_sidebar = false;
            let tip_on = false;
            let planet_tip_on = false;
            let system_tip_on = false;
            let faction_tracker = {};
            let system_tracker = {};
            let system_objects_chart;
            let planet_tracker;
            let planet_obects = {};
            let asset_tracker;
            let asset_objects = {};
            let influence_tracker = {};
            let dir = {'influence': -1, 'faction': -1, 'name': -1, 'location': -1};
            let viewport_w = window.innerWidth;
            let viewport_h = window.innerHeight;
            let isFirefox = typeof InstallTrigger !== 'undefined';
            // let isChrome = !!window.chrome && (!!window.chrome.webstore || !!window.chrome.runtime);
        </script>
        <script src="scripts/utils.js"></script>
    </head>
    <body>
        <div class="se-pre-con"></div>
        <div class="viewer">
            <div id="osd" style="width: 100%; height: 100%"></div>
        </div>
        <script type="text/javascript">
            const viewer = OpenSeadragon({
                id: 'osd',
                prefixUrl: 'openseadragon/images/',
                tileSources: 'map_blank.dzi',
                navigationControlAnchor: OpenSeadragon.ControlAnchor.TOP_LEFT
            });

            let svg_overlay = viewer.svgOverlay();
            $(window).resize(() => {
                svg_overlay.resize();
                viewport_w = window.innerWidth;
                viewport_h = window.innerHeight;
            });
            viewer.controls.topleft.style.position = 'relative';
            viewer.controls.topleft.style.width = '105px';
            viewer.controls.topleft.style.top = '10px';
            viewer.controls.topleft.style.margin = '0px auto';
            viewer.addHandler('open', onViewerOpen());
        </script>
        <div id="factionsCol">
            <div id="factionsCenter">
                <table id="factionTable">
                    <tr id="Pyxis-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Pyxis")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Pyxis')"
                        >
                            PYXIS
                        </td>
                        <td class="faction_color">
                            <div id="Pyxis-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Eridanus-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Eridanus")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Eridanus')"
                        >
                            ERIDANUS
                        </td>
                        <td class="faction_color">
                            <div id="Eridanus-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Triangulum-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Triangulum")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Triangulum')"
                        >
                            TRIANGULUM
                        </td>
                        <td class="faction_color">
                            <div id="Triangulum-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Crux-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Crux")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Crux')"
                        >
                            CRUX
                        </td>
                        <td class="faction_color">
                            <div id="Crux-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Fornax-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Fornax")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Fornax')"
                        >
                            FORNAX
                        </td>
                        <td class="faction_color">
                            <div id="Fornax-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Lyra-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Lyra")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Lyra')"
                        >
                            LYRA
                        </td>
                        <td class="faction_color">
                            <div id="Lyra-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Serpens-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Serpens")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Serpens')"
                        >
                            SERPENS
                        </td>
                        <td class="faction_color">
                            <div id="Serpens-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Reticulum-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Reticulum")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Reticulum')"
                        >
                            RETICULUM
                        </td>
                        <td class="faction_color">
                            <div id="Reticulum-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Aquila-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/House_Aquila")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('House Aquila')"
                        >
                            AQUILA
                        </td>
                        <td class="faction_color">
                            <div id="Aquila-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Trilliant-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_Trilliant_Ring")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Trilliant Ring')"
                        >
                            TRILLIANT
                        </td>
                        <td class="faction_color">
                            <div id="Trilliant-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Prism-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_PRISM_Network")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The PRISM Network')"
                        >
                            PRISM
                        </td>
                        <td class="faction_color">
                            <div id="Prism-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="SERAPH-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/Society_for_Ethical_Reform_through_Aid,_Protection,_and_Humanitarianism")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('SERAPH')"
                        >
                            SERAPH
                        </td>
                        <td class="faction_color">
                            <div id="SERAPH-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="DCS-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_Deathless")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Deathless')"
                        >
                            DCS
                        </td>
                        <td class="faction_color">
                            <div id="DCS-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Vagrant-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/Confederation_of_the_Upright_Vagrant")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('Confederation of the Upright Vagrant')"
                        >
                            VAGRANT
                        </td>
                        <td
                            class="faction_color"
                        >
                            <div id="Vagrant-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="DM-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_Democratic_Mandate")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Democratic Mandate')"
                        >
                            DM
                        </td>
                        <td class="faction_color">
                            <div id="DM-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="Vela-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_Velan_Ascendancy")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Velan Ascendency')"
                        >
                            VELA
                        </td>
                        <td class="faction_color">
                            <div id="Vela-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="UPC-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/Unified_People&#39;s_Collective")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Unified People\'s Collective')"
                        >
                            UPC
                        </td>
                        <td class="faction_color">
                            <div id="UPC-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="HM-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_Houses_Minor")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The Houses Minor')"
                        >
                            HM
                        </td>
                        <td class="faction_color">
                            <div id="HM-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                    <tr id="HC-row">
                        <td
                            class="faction_name"
                            onclick='window.open("https://far-verona.fandom.com/wiki/The_High_Church_of_Messiah-as-Emperox")'
                            onmouseout="hideFactionInfo()"
                            onmouseover="displayFactionInfo('The High Church of Messiah-as-Emperox')"
                        >
                            HC
                        </td>
                        <td class="faction_color">
                            <div id="HC-cell" style="width:100%;height:100%;background-color: #222" onclick="autoSearch(this.id)"></div>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

        <div class="tooltip" id="tip">
            <table
                border="0"
                cellpadding="4"
                cellspacing="0"
                style="margin: 0; border-bottom: 1px dotted #404040"
                width="100%"
            >
                <tr>
                    <td id="tip_fac" style="height: 10px; font-size:12px; line-height: 0; color: #fff;"></td>
                    <td
                        align="right"
                        id="tip_stats"
                        style="height: 10px; font-size:12px; line-height: 0; color: #fff;"
                    ></td>
                </tr>
            </table>

            <p id="tip_name" style="font-size:24px; margin-top: 10px; margin-bottom: 10px; color: #fff; font-weight: bold"></p>
            <table border="0" cellpadding="0" cellspacing="0" style="margin: 0" width="100%">
                <tr>
                    <td
                        align="center"
                        id="tip_hp"
                        style="font-size:18px; line-height: 18px; color: #fff;"
                        valign="bottom"
                        width="18%"
                    ></td>
                    <td
                        align="center"
                        id="tip_cost"
                        style="font-size:18px; line-height: 18px; color: #fff;"
                        valign="bottom"
                        width="18%"
                    ></td>
                    <td
                        align="center"
                        id="tip_tl"
                        style="font-size:18px; line-height: 18px; color: #fff;"
                        valign="bottom"
                        width="18%"
                    ></td>
                    <td
                        align="center"
                        id="tip_atk"
                        style="font-size:18px; line-height: 18px; color: #fff;"
                        valign="bottom"
                        width="23%"
                    ></td>
                    <td
                        align="center"
                        id="tip_cnt"
                        style="font-size:18px; line-height: 18px; color: #fff;"
                        valign="bottom"
                        width="23%"
                    ></td>
                </tr>
                <tr>
                    <td
                        align="center"
                        style="font-size:12px; line-height: 12px; color: #fff; padding-top: 4px"
                        valign="bottom"
                    >
                        <img alt="" class="icon" src="img/hp_icon.png" />
                    </td>
                    <td
                        align="center"
                        style="font-size:12px; line-height: 12px; color: #fff; padding-top: 4px"
                        valign="bottom"
                    >
                        <img alt="" class="icon" src="img/cost_icon.png" />
                    </td>
                    <td
                        align="center"
                        style="font-size:12px; line-height: 12px; color: #fff; padding-top: 4px"
                        valign="bottom"
                    >
                        <img alt="" class="icon" src="img/tl_icon.png" />
                    </td>
                    <td
                        align="center"
                        style="font-size:12px; line-height: 12px; color: #fff; padding-top: 4px"
                        valign="bottom"
                    >
                        <img alt="" class="icon" src="img/atk_icon.png" />
                    </td>
                    <td
                        align="center"
                        style="font-size:12px; line-height: 12px; color: #fff; padding-top: 4px"
                        valign="bottom"
                    >
                        <img alt="" class="icon" src="img/def_icon.png" />
                    </td>
                </tr>
                <tr>
                    <table style="margin-top: 10px" width="100%">
                        <tr id="tip_row_stealth">
                            <td style="font-size:12px; line-height: 12px; color: #fff; padding-right: 10px" align="right" valign="middle">
                                <b>Stealth</b>
                            </td>
                            <td id="tip_stealth" style="font-size:12px; line-height: 12px; color: #fff;">
                                An asset that has been Stealthed cannot be detected or attacked by other factions. If the unit normally requires the permission of a planetary government to be moved onto a planet, that permission may be foregone. An asset loses its Stealth if it is used to attack or defend.
                            </td>
                        </tr>
                        <tr id="tip_row_special">
                            <td style="font-size:12px; line-height: 12px; color: #fff; padding: 10px 10px 0 0" align="right" valign="middle">
                                <b>Special</b>
                            </td>
                            <td id="tip_special" style="font-size:12px; line-height: 12px; color: #fff; padding-top: 10px"></td>
                        </tr>
                        <tr id="tip_row_status">
                            <td id="tip_status_label" style="font-size:12px; line-height: 12px; color: #fff; padding: 10px 10px 0 0" align="right" valign="middle"></td>
                            <td id="tip_status" style="font-size:12px; line-height: 12px; color: #fff; padding-top: 10px"></td>
                        </tr>
                        <tr id="tip_row_perm">
                            <td colspan="2" id="tip_perm" style="font-size:12px; line-height: 12px; color: #fff;"></td>
                        </tr>
                    </table>
                </tr>
            </table>
        </div>
        <div class="tooltip" id="planet_tip">
            <table
                border="0"
                cellpadding="4"
                cellspacing="0"
                style="margin: 0; border-bottom: 1px dotted #404040"
                width="100%"
            >
                <tr>
                    <td id="planet_tip_fac" style="color:#fff; height: 10px; font-size: 12px; line-height: 0"></td>
                    <td
                        align="right"
                        id="planet_tip_sys"
                        style="color:#fff; height: 10px; font-size:12px; line-height: 0"
                    ></td>
                </tr>
            </table>

            <p id="planet_tip_name" style="color:#fff; font-size:24px; margin-top: 10px; margin-bottom: 10px; font-weight: bold"></p>
            <table border="0" cellpadding="2" cellspacing="0" style="margin: 0" width="100%">
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/pcvi_icon.png" />
                    </td>
                    <td id="planet_tip_pcvi" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/tl_icon.png" />
                    </td>
                    <td id="planet_tip_tl" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/pop_icon.png" />
                    </td>
                    <td id="planet_tip_pop" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/atmo_icon.png" />
                    </td>
                    <td id="planet_tip_atmo" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/temp_icon.png" />
                    </td>
                    <td id="planet_tip_temp" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/bio_icon.png" />
                    </td>
                    <td id="planet_tip_bio" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
                <tr>
                    <td style="width: 30px; padding: 5px 5px 5px 0">
                        <img alt="" class="icon" src="img/tags_icon.png" />
                    </td>
                    <td id="planet_tip_tags" style="color:#fff; font-size: 14px; line-height: 14px"></td>
                </tr>
            </table>

            <div id="planet_tip_chart" style="position: relative; top: 5px;"></div>
        </div>
        <div class="tooltip" id="system_tip">
            <table border="0" cellpadding="10" cellspacing="0" width="100%">
                <tr>
                    <td>
                        <table
                                border="0"
                                cellpadding="10"
                                cellspacing="0"
                                style="border-bottom: 1px dotted #404040"
                                width="100%"
                        >
                            <tr>
                                <td id="system_tip_name" style="font-size: 20px">
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <div id="system_objects_chart_container"></div>
            <div id="system_tip_chart" style="position: relative; top: 5px;"></div>
        </div>
        <script type="text/javascript">
            for (let fac in factions) {
                if (factions.hasOwnProperty(fac) && fac !== 'The Guild') {
                    let cell = document.getElementById(factions[fac]['short'] + '-cell');
                    cell.style.backgroundColor = factions[fac]['color'];
                    if (inactive_factions.includes(fac)) {
                        cell.innerHTML = "<img src='assets_alpha/Inactive.png' alt='' />";
                    }
                }
            }
        </script>
        <script type="text/javascript">
            const planet_tip_chart = new ApexCharts(document.querySelector('#planet_tip_chart'), {
                chart: {
                    type: 'donut',
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 100,
                        animateGradually: {
                            enabled: true,
                            delay: 500
                        },
                        dynamicAnimation: {
                            enabled: true,
                            speed: 100
                        }
                    },
                    fontFamily: 'D-DIN, Helvetica, Arial, sans-serif',
                    parentHeightOffset: 15,
                    dropShadow: {
                        enabled: false
                    }
                },
                title: {
                    text: 'Influence',
                    align: 'center',
                    offsetY: 176,
                    floating: true,
                    style: {
                        color: '#ffffff',
                        fontWeight: 'bold'
                    }
                },
                series: [],
                legend: {
                    show: true,
                    floating: true,
                    position: 'bottom',
                    labels: {
                        colors: '#ffffff'
                    },
                    itemMargin: {
                        horizontal: 5
                    }
                },
                stroke: {
                    show: true,
                    width: 4,
                    colors: ['#141414']
                },
                dataLabels: {
                    enabled: true,
                    style: {
                        fontSize: '16px'
                    },
                    dropShadow: {
                        enabled: false
                    }
                },
                plotOptions: {
                    pie: {
                        offsetY: 10,
                        donut: {
                            size: '50%'
                        }
                    }
                }
            });
            planet_tip_chart.render();
        </script>
        <script type="text/javascript">
            const system_tip_chart = new ApexCharts(document.querySelector('#system_tip_chart'), {
                chart: {
                    type: 'donut',
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 100,
                        animateGradually: {
                            enabled: true,
                            delay: 500
                        },
                        dynamicAnimation: {
                            enabled: true,
                            speed: 100
                        }
                    },
                    fontFamily: 'D-DIN, Helvetica, Arial, sans-serif',
                    parentHeightOffset: 15,
                    dropShadow: {
                        enabled: false
                    }
                },
                title: {
                    text: 'Influence',
                    align: 'center',
                    offsetY: 176,
                    floating: true,
                    style: {
                        color: '#ffffff',
                        fontWeight: 'bold'
                    }
                },
                series: [],
                legend: {
                    show: true,
                    floating: true,
                    position: 'bottom',
                    labels: {
                        colors: '#ffffff'
                    },
                    itemMargin: {
                        horizontal: 5
                    }
                },
                stroke: {
                    show: true,
                    width: 4,
                    colors: ['#141414']
                },
                dataLabels: {
                    enabled: true,
                    style: {
                        fontSize: '16px'
                    },
                    dropShadow: {
                        enabled: false
                    }
                },
                plotOptions: {
                    pie: {
                        offsetY: 10,
                        donut: {
                            size: '50%'
                        }
                    }
                }
            });
            system_tip_chart.render();
        </script>
        <script type="text/javascript">
            const tip = document.getElementById('tip');
            const planet_tip = document.getElementById('planet_tip');
            const system_tip = document.getElementById('system_tip');
            let x_offset = false;
            let y_offset = false;

            window.onmousemove = function(e) {
                let mouse_x = e.clientX;
                let mouse_y = e.clientY;

                if (tip_on === true || planet_tip_on === true || system_tip_on === true) {
                    if (x_offset) {
                        tip.style.left = mouse_x - tip.offsetWidth - 20 + 'px';
                        planet_tip.style.left = mouse_x - planet_tip.offsetWidth - 20 + 'px';
                        system_tip.style.left = mouse_x - system_tip.offsetWidth - 20 + 'px';
                    } else {
                        tip.style.left = mouse_x + 20 + 'px';
                        planet_tip.style.left = mouse_x + 20 + 'px';
                        system_tip.style.left = mouse_x + 20 + 'px';
                    }

                    if (y_offset) {
                        tip.style.top = Math.max(mouse_y - tip.offsetHeight - 20, 5) + 'px';
                        planet_tip.style.top = Math.max(mouse_y - planet_tip.offsetHeight - 20, 5) + 'px';
                        system_tip.style.top = Math.max(mouse_y - system_tip.offsetHeight - 20, 5) + 'px';
                    } else {
                        tip.style.top = Math.min(mouse_y + 20, viewport_h - tip.offsetHeight - 5) + 'px';
                        planet_tip.style.top =
                            Math.min(mouse_y + 20, viewport_h - planet_tip.offsetHeight - 5) + 'px';
                        system_tip.style.top =
                            Math.min(mouse_y + 20, viewport_h - system_tip.offsetHeight - 5) + 'px';
                    }
                } else {
                    x_offset = mouse_x > viewport_w * 0.5;
                    y_offset = mouse_y > viewport_h * 0.5;
                }
            };
        </script>

        <div id="sectorinfluence">
            <table border="0" cellpadding="10" cellspacing="0" width="100%">
                <tr>
                    <td>
                        <table
                            border="0"
                            cellpadding="10"
                            cellspacing="0"
                            style="border-bottom: 1px dotted #404040"
                            width="100%"
                        >
                            <tr>
                                <td style="font-size: 20px">
                                    <b>Total Sector Influence</b>
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <div id="sectorinfluence_chart" style="position: relative; top: 5px;"></div>
        </div>
        <script type="text/javascript">
            const sectorinfluence_chart = new ApexCharts(document.querySelector('#sectorinfluence_chart'), {
                chart: {
                    type: 'donut',
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 100,
                        animateGradually: {
                            enabled: true,
                            delay: 500
                        },
                        dynamicAnimation: {
                            enabled: true,
                            speed: 100
                        }
                    },
                    fontFamily: 'D-DIN, Helvetica, Arial, sans-serif',
                    parentHeightOffset: 15,
                    dropShadow: {
                        enabled: false
                    }
                },
                series: [],
                legend: {
                    show: true,
                    floating: true,
                    position: 'bottom',
                    labels: {
                        colors: '#ffffff'
                    },
                    itemMargin: {
                        horizontal: 5
                    }
                },
                stroke: {
                    show: true,
                    width: 4,
                    colors: ['#141414']
                },
                dataLabels: {
                    enabled: true,
                    style: {
                        fontSize: '16px'
                    },
                    dropShadow: {
                        enabled: false
                    },
                    formatter: (val) => {
                        if (val > 5) {
                            return Math.round(val * 10) / 10 + '%';
                        } else {
                            return '';
                        }
                    }
                },
                plotOptions: {
                    pie: {
                        offsetY: 10,
                        donut: {
                            size: '50%'
                        }
                    }
                }
            });
            sectorinfluence_chart.render();
        </script>

        <div id="info">
            <table border="0" cellpadding="10" cellspacing="0" width="100%">
                <tr>
                    <td colspan="8">
                        <table
                            border="0"
                            cellpadding="10"
                            cellspacing="0"
                            style="border-bottom: 1px dotted #404040"
                            width="100%"
                        >
                            <tr>
                                <td id="info_faction" style="font-size: 20px; font-weight: bold"></td>
                                <td align="right" id="info_homeworld" style="font-size: 12px" valign="bottom"></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td
                        align="center"
                        id="info_force"
                        style="font-size:42px; line-height: 38px; padding-top: 10px"
                        valign="bottom"
                        width="40"
                    ></td>
                    <td
                        align="center"
                        id="info_cunning"
                        style="font-size:42px; line-height: 38px"
                        valign="bottom"
                        width="40"
                    ></td>
                    <td
                        align="center"
                        id="info_wealth"
                        style="font-size:42px; line-height: 38px"
                        valign="bottom"
                        width="40"
                    ></td>
                    <td align="center" id="info_hp" style="font-size:20px" valign="bottom" width="50"></td>
                    <td align="center" id="info_income" style="font-size:20px" valign="bottom" width="40"></td>
                    <td align="center" id="info_balance" style="font-size:20px" valign="bottom" width="40"></td>
                    <td align="center" id="info_exp" style="font-size:20px" valign="bottom" width="40"></td>
                    <td valign="bottom" width="40">
                        <table border="0" cellpadding="0" cellspacing="0" width="100%">
                            <tr>
                                <td align="center" id="info_infl_abs" style="font-size:16px" valign="bottom">
                                    400
                                </td>
                            </tr>
                            <tr>
                                <td align="center" id="info_infl_rel" style="font-size:16px" valign="bottom">
                                    23.2%
                                </td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr style="border-bottom: 1px dotted #fff">
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Force
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Cunning
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Wealth
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        HP
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Income
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Balance
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        EXP
                    </td>
                    <td align="center" style="font-size:14px; padding-top: 0">
                        Influence
                    </td>
                </tr>
            </table>

            <table border="0" cellpadding="4" cellspacing="0" style="margin: 20px 10px 0 10px">
                <tr>
                    <td id="info_tag" style="font-size:20px"></td>
                </tr>
                <tr>
                    <td align="justify" id="info_tagdesc"></td>
                </tr>
            </table>

            <table border="0" cellpadding="4" cellspacing="0" style="margin: 20px 10px 0 10px">
                <tr>
                    <td id="info_goal" style="font-size:20px"></td>
                </tr>
                <tr>
                    <td align="justify" id="info_goaldesc"></td>
                </tr>
            </table>

            <table border="0" cellpadding="4" cellspacing="0" style="margin: 20px 10px 0 10px">
                <tr>
                    <td align="justify" id="info_notes"></td>
                </tr>
            </table>
        </div>

        <div id="sidebar">

            <div id="search-container">
                <input type="text" id="search-bar" onkeyup="filterList()" placeholder="Search ..." />

                <div id="del_button" onclick="delFilter()">
                    <img id="delButtonImg" src="img/del_icon.png" alt="" />
                </div>
            </div>

            <div id="sort-container">
                <div id="sort_by">
                    <table>
                        <tr>
                            <td id="sort_influence" onclick="sortBy('influence')">
                                Influence
                            </td>
                            <td id="sort_faction" onclick="sortBy('faction')">
                                Faction
                            </td>
                            <td id="sort_asset" onclick="sortBy('name')">
                                Asset
                            </td>
                            <td id="sort_location" onClick="sortBy('location')">
                                Location
                            </td>
                        </tr>
                    </table>
                </div>
            </div>

            <div id="assetPool"></div>

        </div>

        <div id="sidebarToggle" onclick="toggleSidebar()"></div>

        <div
            id="sectorinfluence_toggle"
            onmouseenter="displaySectorInfluence()"
            onmouseleave="hideSectorInfluence()"
        >
            <img alt="" src="img/donut_chart.png" style="width: 50px; height: auto;" />
        </div>

<!--        <div id="credits">-->
<!--            <a href="https://sea-watch.org/en/" rel="noopener noreferrer" target="_blank"-->
<!--                ><img alt="" src="img/SeaWatch.png" style="width: 50px; height: auto;"-->
<!--            /></a>-->
<!--        </div>-->

        <div
            id="visibilityToggle"
            onclick="toggleInactiveFactions()"
            onmouseenter="visibilityToggleStyling('in')"
            onmouseleave="visibilityToggleStyling('out')"
        ></div>

<!--        <div id="factionToggle" onclick="toggleFactionTable()"></div>-->
    </body>
</html>
